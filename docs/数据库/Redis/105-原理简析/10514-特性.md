# 特性

### 类型检查与命令多态

Redis中用于操作键的命令基本上可以分为两种类型。

* 可以对任何类型的键执行，DEL, EXPIRE, RENAME, TYPE, OBEJCT命令等
* 只能读特定类型的键执行H R L S Z前缀的命令

在执行一个类型特定的命令之前，rdis会检查输入键的类型是否正确，在决定是否能够执行命令。通过redisObject中的type属性实现的。 除了根据值对象的类型来判断命令是否可以正确执行外，还会根据值对象的编码方式，选择正确的命令实现代码来执行命令。

### 内存回收

C语言不具备自动内存回收功能，所以Redis在自己的对象系统中构建了一个引用计数技术实现的内存回收机制，通过跟踪对象的引用计数信息，在适当的时候释放对象并进行内存回收。

`refcount`属性

1. 在创建一个新对象时，引用计数的值会被初始化1
2. 对象被一个新程序使用时，引用计数值会增1
3. 对象不再被一个程序引用时，引用计数值减1
4. 引用基数值为0时，对象占用的内存被释放。

### 对象共享

引用计数也可以用于实现对象共享，嵌套结构都可以使用

1. 将数据库键的值指向一个现有的值对象
2. 将被共享的值对象引用计数增1 节约内存。数据库初始的时候会创建0~9999的字符串对象，以供共享

OBJECT REFCOUNT命令查看键的引用计数

### 对象的空转时长

`lru`属性，记录了对象最后一次被命令程序访问的时间，OBJECT IDLETIME命令可以进行访问键的空转时长= 当前时间 - lru 当服务器用于回收内存的算法是volatile-lru或者allkeys-lry，那么当服务器内存数超过了maxmemory选项设置的上限，空转时长较高的那部分键会被服务器优先释放。

